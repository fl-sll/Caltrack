<!DOCTYPE html>
<html>
    <head>
        <title> CalTrack Profile </title>
        <link rel="stylesheet" href="profile.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <div class="header" id="myHeader">
            <a href="Diets.html"> Diets </a>
            <a class="active" href="profile.html"> Profile </a>
            <a href="MyDiet.html"> My Diet </a>
            <a href="index.html"> Home </a>
            <img src="logo.jpg" align="left" style="margin-left:6px; width: 50px; height:50px">
        </div>
        <!-- <div class="pic">
            <p><label for="file" style="cursor:pointer;"> Upload Your Image : </label></p>
            <input type="file" accept="image/*" name="image" id="file" onchange="loadFile(event)">
            <p><img id="output" width="200" /></p>
            <script type="text/javascript" src="profile.js"></script>
        </div> -->
        <div class="page">
            <h1 class="head"> Profile </h1>
            <div class="form">
                <img class="image" src="https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500">
                <div class="content">
                <div class="calc-outer-wrap">
                <div id="form-error" style="display:none;"></div>
                    <h3> Name: <input type="text"> </h3>
                <form class="calc-form" id="calc-form">
                    <div class="form-field">
                        <div class="field-outer">
                            <label for="distance" class="top-label"> Age: </label>
                            <div class="field-items">
                                <div class="field field-large">
                                    <input type="text" name="age" inputmode="numeric" pattern="[0-9]*">
                                </div>
                                <div class="field field-medium">
                                    <select name="gender">
                                        <option valie="Male"> Male </option> 
                                        <option value="Female"> Female </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="field-outer">
                            <label for="height" class="top-label"> Height: </label>
                            <div class="field-items">
                                <div class="field">
                                    <input type="text" name="height" id="height" inputmode="numeric" pattern="[0-9]*" placeholder="(in cm)">
                                </div>
                            </div>
                        </div>
                        <div class="field-outer">
                            <label for="weight" class="top-label"> Your Weight: </label>
                            <div class="field-items">
                                <div class="field field-large">
                                    <input type="text" name="weight" id="weight" inputmode="numeric" pattern="[0-9]*" placeholder="(in Kg)">
                                </div>
                            </div>
                        </div>
                        <br>
                        <div class="btn-wrp field-outer">
                            <button class="form-submit" onclick="main()"> Calculate </button>
                        </div>
                    </div>
                </form>
                <div id="results" style="display:none;"></div>
                </div>
                </div>
            </div>
        </div>
        <div class="list">
            <h1> List of Diets you are currently on </h1>
            <div class="diets">
                <a class="diet" href="Diets.html"> High Fibers </a>
                <a class="diet" href="Diets.html"> Low Fats </a>
            </div>
        </div>
        <script>
            window.onscroll = function() {myFunction()};

            var header = document.getElementById("myHeader");
            var sticky = header.offsetTop;

            function myFunction() {
              if (window.pageYOffset > sticky) {
                header.classList.add("sticky");
              } else {
                header.classList.remove("sticky");
              }
            }
            (function main() {
                const form  = document.getElementById('calc-form');
                const results = document.getElementById('results');
                const errors = document.getElementById('form-error');

                function errorMessage(m) {
                    errors.innerHTML = m;
                    errors.style.display = '';
                    return false;
                }

                function showResults(calories) {
                    results.innerHTML = `<p>Your Basal Metabolic Rate (BMR) is: <strong>${(calories).toFixed(2)} </strong> calories a day.</p><a href="#" id="rs">revise</a>`;
                    results.style.display = ''
                    form.style.display = 'none'
                    errors.style.display = 'none'
                }
                function resetForm(e) {
                if(e.target.id = 'rs') {
                    e.preventDefault();
                    results.style.display = 'none';
                    form.style.display = '';
                    form.reset()
                }
                }
                function submitHandler(e) {
                    e.preventDefault();

                    // Age
                    let age = parseFloat(form.age.value);
                    if(isNaN(age) || age < 0) {
                        return errorMessage('Please enter a valid age');
                    }
                    // Height
                    let height = parseFloat(form.height.value);
                    if(isNaN(height) || age < 0) {
                        return errorMessage('Please enter a valid height');
                    }
                    // Weight
                    let weight = parseFloat(form.weight.value);
                    if(isNaN(weight) || age < 0) {
                        return errorMessage('Please enter a valid weight');
                    }

                let calories = 0;
                if(form.gender.value == 'Female') {
                    calories = 655.09 + (9.56 * weight) + (1.84 * height) - (4.67 * age);
                    }  else {
                    calories = 66.47 + (13.75 * weight) + (5 * height) - (6.75 * age);
                    }

                showResults(calories);
                }
                form.addEventListener('submit', submitHandler);
                results.addEventListener('click', resetForm, true);

            })();
        </script>
    </body>
</html>